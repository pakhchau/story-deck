<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta property="og:title" content="SETTLD ‚Äî The Agent Opportunity">
<meta property="og:description" content="Bridge crypto wealth to VIP casino experiences. Become an agent.">
<title>SETTLD ‚Äî The Agent Opportunity</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  html, body {
    width: 100%; height: 100vh; overflow: hidden;
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif;
    background: #000; color: #f0f0f0;
    -webkit-font-smoothing: antialiased; touch-action: none;
  }
  #canvas { width: 100%; height: 100vh; position: relative; overflow: hidden; }
  .slide {
    position: absolute; inset: 0;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    padding: 60px 28px 80px;
    transition: opacity 0.35s ease, transform 0.35s ease;
    will-change: transform, opacity; overflow-y: auto;
  }
  .slide.exit-left   { transform: translateX(-100%); opacity: 0; }
  .slide.exit-right  { transform: translateX(100%);  opacity: 0; }
  .slide.exit-up     { transform: translateY(-100%);  opacity: 0; }
  .slide.exit-down   { transform: translateY(100%);   opacity: 0; }
  .slide.enter-left  { transform: translateX(-100%); opacity: 0; }
  .slide.enter-right { transform: translateX(100%);  opacity: 0; }
  .slide.enter-up    { transform: translateY(-100%);  opacity: 0; }
  .slide.enter-down  { transform: translateY(100%);   opacity: 0; }
  .slide.active      { transform: translate(0,0); opacity: 1; }

  .theme-black  { background: linear-gradient(160deg, #0a0a0f 0%, #111118 100%); }
  .theme-gold   { background: linear-gradient(160deg, #0a0a0f 0%, #1a1505 50%, #2a1f08 100%); }
  .theme-deep   { background: linear-gradient(160deg, #0a0a0f 0%, #0d1520 100%); }
  .theme-accent { background: linear-gradient(160deg, #0a0a0f 0%, #1a0a12 50%, #2a0e1a 100%); }
  .theme-green  { background: linear-gradient(160deg, #0a0a0f 0%, #0a1a10 100%); }
  .theme-warm   { background: linear-gradient(160deg, #0f0a08 0%, #1a1008 100%); }

  h1 { font-size: clamp(26px, 6.5vw, 50px); font-weight: 800; letter-spacing: -0.03em; line-height: 1.08; text-align: center; margin-bottom: 16px; max-width: 680px; }
  h2 { font-size: clamp(20px, 4.5vw, 34px); font-weight: 700; letter-spacing: -0.02em; line-height: 1.15; text-align: center; margin-bottom: 12px; max-width: 620px; }
  p, .body { font-size: clamp(14px, 3.5vw, 18px); line-height: 1.65; text-align: center; max-width: 560px; opacity: 0.85; }
  .emoji-big { font-size: clamp(44px, 11vw, 80px); margin-bottom: 20px; }
  .label { font-size: 10px; font-weight: 700; letter-spacing: 0.2em; text-transform: uppercase; opacity: 0.35; margin-bottom: 14px; }
  .stat { font-size: clamp(40px, 10vw, 72px); font-weight: 900; letter-spacing: -0.03em; line-height: 1; margin: 8px 0; color: #d4af37; }
  .stat-label { font-size: clamp(13px, 2.8vw, 16px); opacity: 0.5; margin-top: 6px; }
  .accent { color: #d4af37; font-weight: 700; }
  .accent-red { color: #e94560; font-weight: 700; }
  .accent-green { color: #2ecc71; font-weight: 700; }
  .quote { font-style: italic; font-size: clamp(16px, 3.8vw, 23px); line-height: 1.5; max-width: 500px; border-left: 2px solid rgba(212,175,55,0.4); padding-left: 20px; text-align: left; }
  table { border-collapse: collapse; font-size: clamp(11px, 2.5vw, 14px); width: 90%; max-width: 460px; margin: 14px 0; }
  th, td { padding: 8px 10px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.08); }
  th { font-weight: 700; opacity: 0.5; font-size: 0.85em; text-transform: uppercase; letter-spacing: 0.08em; }
  .pill { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 11px; font-weight: 700; letter-spacing: 0.06em; margin: 3px; }
  .pill-gold { background: rgba(212,175,55,0.15); color: #d4af37; border: 1px solid rgba(212,175,55,0.25); }
  .pill-white { background: rgba(255,255,255,0.06); color: rgba(255,255,255,0.7); border: 1px solid rgba(255,255,255,0.1); }
  .flow-row { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; justify-content: center; margin: 10px 0; }
  .flow-box { background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08); border-radius: 10px; padding: 12px 16px; text-align: center; min-width: 80px; }
  .flow-arrow { opacity: 0.3; font-size: 18px; }
  .list-item { text-align: left; max-width: 480px; margin: 6px 0; font-size: clamp(13px, 3vw, 17px); line-height: 1.6; opacity: 0.85; }

  /* Nav */
  #topbar { position: fixed; top: 0; left: 0; right: 0; height: 48px; display: flex; align-items: center; padding: 0 16px; z-index: 200; background: linear-gradient(to bottom, rgba(0,0,0,0.6), transparent); }
  #breadcrumb { font-size: 12px; font-weight: 600; opacity: 0.6; display: flex; align-items: center; gap: 4px; flex: 1; }
  #breadcrumb .crumb { opacity: 0.4; cursor: pointer; transition: opacity 0.2s; }
  #breadcrumb .crumb:hover { opacity: 0.8; }
  #breadcrumb .crumb.current { opacity: 1; color: #d4af37; }
  #breadcrumb .sep { opacity: 0.15; margin: 0 2px; font-size: 10px; }
  #counter { font-size: 11px; font-weight: 700; opacity: 0.4; letter-spacing: 0.05em; margin-left: auto; }
  #map-toggle { width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; font-size: 18px; cursor: pointer; opacity: 0.4; transition: opacity 0.2s; margin-left: 12px; border-radius: 6px; }
  #map-toggle:hover { opacity: 0.9; background: rgba(255,255,255,0.06); }
  #progress-bar { position: fixed; top: 48px; left: 0; right: 0; height: 2px; z-index: 200; display: flex; gap: 2px; padding: 0 16px; }
  #progress-bar .seg { flex: 1; height: 2px; border-radius: 1px; background: rgba(255,255,255,0.08); transition: background 0.3s; }
  #progress-bar .seg.visited { background: rgba(212,175,55,0.3); }
  #progress-bar .seg.active { background: rgba(212,175,55,0.9); }
  #progress-bar .seg.has-children::after { content: ''; position: absolute; bottom: -3px; left: 50%; transform: translateX(-50%); width: 3px; height: 3px; border-radius: 50%; background: rgba(212,175,55,0.3); }
  #dive-indicator { position: fixed; bottom: 0; left: 0; right: 0; display: flex; flex-direction: column; align-items: center; padding-bottom: 16px; z-index: 200; opacity: 0; transition: opacity 0.3s; pointer-events: none; background: linear-gradient(to top, rgba(0,0,0,0.4), transparent); padding-top: 30px; }
  #dive-indicator.visible { opacity: 1; }
  #dive-indicator .arrow { font-size: 18px; opacity: 0.5; animation: bd 1.5s ease-in-out infinite; }
  #dive-indicator .dive-label { font-size: 10px; font-weight: 600; letter-spacing: 0.12em; text-transform: uppercase; opacity: 0.3; margin-top: 4px; }
  @keyframes bd { 0%,100%{transform:translateY(0)} 50%{transform:translateY(5px)} }
  #back-indicator { position: fixed; top: 54px; left: 50%; transform: translateX(-50%); display: flex; align-items: center; gap: 6px; z-index: 200; opacity: 0; transition: opacity 0.3s; pointer-events: none; }
  #back-indicator.visible { opacity: 1; pointer-events: auto; cursor: pointer; }
  #back-indicator .arrow { font-size: 13px; opacity: 0.4; }
  #back-indicator .back-label { font-size: 10px; font-weight: 600; letter-spacing: 0.1em; text-transform: uppercase; opacity: 0.3; }
  #depth-rings { position: fixed; left: 12px; top: 50%; transform: translateY(-50%); display: flex; flex-direction: column; align-items: center; gap: 6px; z-index: 200; }
  .depth-ring { width: 6px; height: 6px; border-radius: 50%; border: 1.5px solid rgba(255,255,255,0.15); transition: all 0.3s; }
  .depth-ring.active { border-color: #d4af37; background: #d4af37; box-shadow: 0 0 6px rgba(212,175,55,0.4); }
  .depth-ring.ancestor { border-color: rgba(255,255,255,0.3); background: rgba(255,255,255,0.1); }
  .edge-arrow { position: fixed; top: 50%; transform: translateY(-50%); font-size: 20px; opacity: 0; z-index: 150; transition: opacity 0.2s; pointer-events: none; }
  .edge-arrow.left { left: 24px; }
  .edge-arrow.right { right: 24px; }
  .edge-arrow.visible { opacity: 0.12; }

  #minimap { position: fixed; inset: 0; background: rgba(0,0,0,0.94); z-index: 300; display: none; flex-direction: column; padding: 60px 24px 24px; overflow-y: auto; -webkit-overflow-scrolling: touch; backdrop-filter: blur(20px); }
  #minimap.open { display: flex; }
  #minimap-close { position: fixed; top: 16px; right: 16px; font-size: 22px; cursor: pointer; opacity: 0.5; z-index: 310; }
  #minimap-title { font-size: 10px; font-weight: 700; letter-spacing: 0.16em; text-transform: uppercase; opacity: 0.3; margin-bottom: 20px; }
  .map-node { display: flex; align-items: flex-start; gap: 10px; padding: 7px 0; cursor: pointer; opacity: 0.45; transition: opacity 0.2s; }
  .map-node:hover { opacity: 0.85; }
  .map-node.current { opacity: 1; }
  .map-node .map-dot { width: 7px; height: 7px; border-radius: 50%; border: 1.5px solid rgba(255,255,255,0.25); margin-top: 5px; flex-shrink: 0; transition: all 0.3s; }
  .map-node.current .map-dot { border-color: #d4af37; background: #d4af37; box-shadow: 0 0 5px rgba(212,175,55,0.4); }
  .map-node .map-label { font-size: 13px; font-weight: 600; line-height: 1.3; }
  .map-node .map-id { font-size: 9px; opacity: 0.25; margin-top: 2px; font-weight: 600; }
  .map-children { padding-left: 18px; border-left: 1px solid rgba(255,255,255,0.04); margin-left: 3px; }
</style>
</head>
<body>
<div id="topbar">
  <div id="breadcrumb"></div>
  <div id="counter"></div>
  <div id="map-toggle" onclick="toggleMap()">‚ò∞</div>
</div>
<div id="progress-bar"></div>
<div id="back-indicator"><span class="arrow">‚Üë</span><span class="back-label">back</span></div>
<div id="dive-indicator"><span class="arrow">‚Üì</span><span class="dive-label">explore</span></div>
<div id="depth-rings"></div>
<div class="edge-arrow left">‚Äπ</div>
<div class="edge-arrow right">‚Ä∫</div>
<div id="minimap">
  <div id="minimap-close" onclick="toggleMap()">‚úï</div>
  <div id="minimap-title">Map</div>
  <div id="minimap-tree"></div>
</div>
<div id="canvas"></div>

<script>
const TREE = { id:"root", children:[
  {
    id:"1", title:"The Opportunity", theme:"black",
    content:`<div class="label">SETTLD</div>
      <h1>The Agent<br>Opportunity</h1>
      <p>Bridge crypto wealth to VIP casino experiences.<br>Run it as a business.</p>`,
    children:[
      {
        id:"1.1", title:"The $200B Gap", theme:"gold",
        content:`<div class="stat">$200B+</div>
          <div class="stat-label">Macau + Asia gaming revenue at 90-95% recovery</div>
          <br><p>The legacy VIP system collapsed. COVID + regulation killed the old junket model.<br><br>
          <span class="accent">New blood needed.</span> That's you.</p>`
      },
      {
        id:"1.2", title:"Old vs New", theme:"black",
        content:`<h2>What Broke</h2>
          <table>
            <tr><th>Old Model</th><th>SETTLD Model</th></tr>
            <tr><td>Credit-based (trust required)</td><td class="accent">Debit/crypto-backed (trustless)</td></tr>
            <tr><td>OTC partners (risky, 4% fees)</td><td class="accent">Stablecoin pools (on-chain, transparent)</td></tr>
            <tr><td>HK regulations limit pool sizes</td><td class="accent">Smart contract pools, no limits</td></tr>
            <tr><td>Must trust your junket operator</td><td class="accent">Funds visible on-chain</td></tr>
            <tr><td>Restricted to legacy networks</td><td class="accent">Open to crypto-native agents</td></tr>
          </table>`
      },
      {
        id:"1.3", title:"Why Now", theme:"deep",
        content:`<h2>Why Now?</h2>
          <p>
            <span class="accent">1.</span> Legacy Macau operators relocated overseas post-crackdown<br><br>
            <span class="accent">2.</span> Crypto wealth is at all-time highs with nowhere to spend<br><br>
            <span class="accent">3.</span> New casino markets opening (UAE 2027, Korea, SE Asia)<br><br>
            <span class="accent">4.</span> Web3 people haven't experienced VIP casino lifestyle<br><br>
            <span class="accent">5.</span> 95% of legacy business flows through agents ‚Äî that model still works
          </p>`
      }
    ]
  },
  {
    id:"2", title:"How It Works", theme:"deep",
    content:`<div class="emoji-big">‚öôÔ∏è</div>
      <h1>How It Works</h1>
      <p>Three steps. Trustless. Transparent.</p>`,
    children:[
      {
        id:"2.1", title:"The Flow", theme:"deep",
        content:`<h2>The Settlement Flow</h2>
          <div class="flow-row">
            <div class="flow-box"><div style="font-size:24px">üí∞</div><div style="font-size:11px;opacity:0.6;margin-top:4px">Client deposits<br>stablecoin</div></div>
            <div class="flow-arrow">‚Üí</div>
            <div class="flow-box"><div style="font-size:24px">üîó</div><div style="font-size:11px;opacity:0.6;margin-top:4px">Visible in<br>liquidity pool</div></div>
            <div class="flow-arrow">‚Üí</div>
            <div class="flow-box"><div style="font-size:24px">üé∞</div><div style="font-size:11px;opacity:0.6;margin-top:4px">Casino issues<br>chips</div></div>
          </div>
          <br><p style="opacity:0.6">Crypto-to-crypto. No OTC. No trust required.<br>The smart contract is the escrow.</p>`
      },
      {
        id:"2.2", title:"Your Role as Agent", theme:"deep",
        content:`<h2>Your Role as Agent</h2>
          <p>
            <span class="accent">‚Üí</span> Bring clients to the platform<br><br>
            <span class="accent">‚Üí</span> Clients deposit into pool<br><br>
            <span class="accent">‚Üí</span> They play at VIP tables<br><br>
            <span class="accent">‚Üí</span> House edge generates GGR<br><br>
            <span class="accent">‚Üí</span> You earn a % of GGR from your clients<br><br>
            <span class="accent-red">You win when the house wins.</span><br>
            <span style="opacity:0.5">And the house always wins.</span>
          </p>`
      },
      {
        id:"2.3", title:"The Yield", theme:"gold",
        content:`<h2>Where Yield Comes From</h2>
          <table>
            <tr><td>Source</td><td class="accent">Gross Gaming Revenue (GGR)</td></tr>
            <tr><td>Baccarat house edge</td><td>~1.5% per hand</td></tr>
            <tr><td>Your share</td><td class="accent">% of pool √ó casino performance</td></tr>
            <tr><td>Theoretical range</td><td>100-200% APY</td></tr>
          </table>
          <br><p style="opacity:0.5">Real yield from real casino operations.<br>Not ponzi tokenomics. Not DeFi vaporware.</p>`
      }
    ]
  },
  {
    id:"3", title:"Who You Are", theme:"warm",
    content:`<div class="emoji-big">üéØ</div>
      <h1>Who This Is For</h1>
      <p>Three types of agents we're looking for</p>`,
    children:[
      {
        id:"3.1", title:"Crypto-Native Operators", theme:"warm",
        content:`<h2>Profile 1:<br>Crypto-Native Operators</h2>
          <p>You have a network of crypto-wealthy friends.<br>They want experiences, not another DeFi protocol.<br><br>
          <span class="accent">You bring them to VIP tables.</span><br>
          <span class="accent">They play. You earn.</span><br><br>
          <span class="pill pill-gold">Web3</span>
          <span class="pill pill-gold">High Net Worth Network</span>
          <span class="pill pill-gold">Experience-Driven</span></p>`
      },
      {
        id:"3.2", title:"Legacy Casino Operators", theme:"warm",
        content:`<h2>Profile 2:<br>Legacy Operators</h2>
          <p>Former junket agents or VIP room operators.<br>You left Macau but still have the network.<br><br>
          <span class="accent">Same business. New rails.</span><br>
          Crypto replaces the OTC. Smart contracts replace trust.<br><br>
          <span class="pill pill-white">Former Junket</span>
          <span class="pill pill-white">Macau Network</span>
          <span class="pill pill-white">Relocated</span></p>`
      },
      {
        id:"3.3", title:"Crossover Players", theme:"warm",
        content:`<h2>Profile 3:<br>Crossover Players</h2>
          <p>You go to BOTH crypto conferences AND casino conferences.<br><br>
          You understand the overlap that nobody else sees.<br><br>
          <span class="accent">You are rare. And you are exactly who we need.</span><br><br>
          <span class="pill pill-gold">Consensus</span>
          <span class="pill pill-gold">Token2049</span>
          <span class="pill pill-white">ICE Barcelona</span>
          <span class="pill pill-white">ACE</span></p>`
      }
    ]
  },
  {
    id:"4", title:"The Vision", theme:"gold",
    content:`<div class="label">Long-term</div>
      <h1>Beyond the Table</h1>
      <p>This isn't just casino settlement.<br>It's a membership. A community. A lifestyle.</p>`,
    children:[
      {
        id:"4.1", title:"Mobility Membership", theme:"gold",
        content:`<h2>The Mobility Membership</h2>
          <p>Think <span class="accent">Soho House</span> for crypto-casino mobility.<br><br>
          Not about the clubhouse (not yet).<br>
          About the <strong>routes</strong>:<br><br>
          üåè SE Asia route<br>
          üèúÔ∏è UAE-Saudi route<br>
          üé∞ Korea-Japan route<br><br>
          <span style="opacity:0.5">One carry-on suitcase. Different country every few days.<br>
          You can bring people ‚Üí you earn.</span></p>`
      },
      {
        id:"4.2", title:"Roadmap", theme:"gold",
        content:`<h2>The Path</h2>
          <p>
            <span class="accent">Phase 1:</span> Contracts with 6 casino locations<br>Use their event spaces and VIP rooms<br><br>
            <span class="accent">Phase 2:</span> Own clubhouses, gym, social spaces<br>Soho House-style, crypto-native<br><br>
            <span class="accent">Phase 3:</span> UAE opening 2027<br>Ras Al Khaimah ‚Äî set the regulatory standard<br>for the next wave of gaming
          </p>`
      },
      {
        id:"4.3", title:"The Brand", theme:"black",
        content:`<div class="quote">"It's not about the tech. It's not even about the liquidity. It's about ACCESS. It's about IDENTITY. It's about COMMUNITY."</div>
          <br><p style="opacity:0.4">If you know, you know.</p>`
      }
    ]
  },
  {
    id:"5", title:"Next Steps", theme:"accent",
    content:`<div class="emoji-big">ü§ù</div>
      <h1>Become an Agent</h1>
      <p>The table is set. The chips are ready.<br><span class="accent">Are you in?</span></p>
      <br><p style="opacity:0.4">pak@settld.org</p>`,
    children:[]
  }
]};

// ‚îÄ‚îÄ ENGINE (same as v2) ‚îÄ‚îÄ
const canvas=document.getElementById('canvas'),breadcrumbEl=document.getElementById('breadcrumb'),counterEl=document.getElementById('counter'),progressEl=document.getElementById('progress-bar'),diveEl=document.getElementById('dive-indicator'),backEl=document.getElementById('back-indicator'),depthEl=document.getElementById('depth-rings'),leftArrow=document.querySelector('.edge-arrow.left'),rightArrow=document.querySelector('.edge-arrow.right');
let path=[0],currentSlideEl=null;
function getNode(p){let n=TREE;for(const i of p){if(!n.children||!n.children[i])return null;n=n.children[i]}return n}
function getSiblings(p){if(!p.length)return TREE.children||[];const pp=p.slice(0,-1),par=p.length===1?TREE:getNode(pp);return par?(par.children||[]):[]}
function currentNode(){return getNode(path)}
function currentIndex(){return path[path.length-1]}
function currentSiblings(){return getSiblings(path)}
function renderSlide(node,dir){if(!node)return;const s=document.createElement('div');s.className=`slide ${node.theme?'theme-'+node.theme:'theme-black'}`;s.innerHTML=node.content;if(dir)s.classList.add('enter-'+dir);else s.classList.add('active');canvas.appendChild(s);if(currentSlideEl){const old=currentSlideEl;const ed=dir==='left'?'right':dir==='right'?'left':dir==='up'?'down':dir==='down'?'up':'left';old.classList.remove('active');old.classList.add('exit-'+ed);setTimeout(()=>old.remove(),400)}requestAnimationFrame(()=>{requestAnimationFrame(()=>{s.classList.remove('enter-left','enter-right','enter-up','enter-down');s.classList.add('active')})});currentSlideEl=s;updateUI()}
function updateUI(){const node=currentNode(),siblings=currentSiblings(),idx=currentIndex(),hasChildren=node&&node.children&&node.children.length>0,isDeep=path.length>1;let crumbs='';for(let d=0;d<path.length;d++){const p=path.slice(0,d+1),n=getNode(p);if(d>0)crumbs+='<span class="sep">‚Ä∫</span>';crumbs+=`<span class="crumb ${d===path.length-1?'current':''}" data-path="${p.join(',')}">${n?(n.title||n.id):''}</span>`}breadcrumbEl.innerHTML=crumbs;breadcrumbEl.querySelectorAll('.crumb').forEach(el=>{el.addEventListener('click',()=>{const tp=el.dataset.path.split(',').map(Number);if(tp.join(',')!==path.join(',')){path=tp;renderSlide(currentNode(),'down')}})});counterEl.textContent=`${idx+1} / ${siblings.length}`;progressEl.innerHTML='';siblings.forEach((sib,i)=>{const seg=document.createElement('div');seg.className='seg';if(i<idx)seg.classList.add('visited');if(i===idx)seg.classList.add('active');if(sib.children&&sib.children.length>0)seg.classList.add('has-children');seg.addEventListener('click',()=>{if(i!==idx){path[path.length-1]=i;renderSlide(currentNode(),i>idx?'left':'right')}});progressEl.appendChild(seg)});if(hasChildren){diveEl.classList.add('visible')}else{diveEl.classList.remove('visible')}if(isDeep)backEl.classList.add('visible');else backEl.classList.remove('visible');depthEl.innerHTML='';if(path.length>1){for(let d=0;d<path.length;d++){const r=document.createElement('div');r.className='depth-ring';if(d===path.length-1)r.classList.add('active');else r.classList.add('ancestor');depthEl.appendChild(r)}}leftArrow.classList.toggle('visible',idx>0);rightArrow.classList.toggle('visible',idx<siblings.length-1)}
const minimap=document.getElementById('minimap'),minimapTree=document.getElementById('minimap-tree');
function toggleMap(){minimap.classList.toggle('open');if(minimap.classList.contains('open'))renderMap()}
function renderMap(){minimapTree.innerHTML='';function rn(node,par,np){const el=document.createElement('div');el.className='map-node';if(np.join(',')===path.join(','))el.classList.add('current');el.innerHTML=`<div class="map-dot"></div><div><div class="map-label">${node.title||node.id}</div><div class="map-id">¬ß${node.id}</div></div>`;el.addEventListener('click',()=>{path=[...np];renderSlide(currentNode(),null);toggleMap()});par.appendChild(el);if(node.children&&node.children.length>0){const cc=document.createElement('div');cc.className='map-children';node.children.forEach((c,i)=>rn(c,cc,[...np,i]));par.appendChild(cc)}}TREE.children.forEach((c,i)=>rn(c,minimapTree,[i]))}
backEl.addEventListener('click',()=>navigate('up'));
let isAnimating=false;
function navigate(a){if(isAnimating)return;isAnimating=true;setTimeout(()=>isAnimating=false,380);const node=currentNode(),siblings=currentSiblings(),idx=currentIndex();switch(a){case'right':if(idx<siblings.length-1){path[path.length-1]++;renderSlide(currentNode(),'left')}else if(path.length>1){path.pop();const pi=path[path.length-1],ps=currentSiblings();if(pi<ps.length-1){path[path.length-1]++;renderSlide(currentNode(),'left')}else renderSlide(currentNode(),'up')}break;case'left':if(idx>0){path[path.length-1]--;renderSlide(currentNode(),'right')}break;case'down':if(node&&node.children&&node.children.length>0){path.push(0);renderSlide(currentNode(),'up')}break;case'up':if(path.length>1){path.pop();renderSlide(currentNode(),'down')}break}}
let tx=0,ty=0,tt=0;
document.addEventListener('touchstart',e=>{tx=e.touches[0].clientX;ty=e.touches[0].clientY;tt=Date.now()},{passive:true});
document.addEventListener('touchend',e=>{const dx=e.changedTouches[0].clientX-tx,dy=e.changedTouches[0].clientY-ty,dt=Date.now()-tt;if(dt>600||(Math.abs(dx)<25&&Math.abs(dy)<25))return;if(Math.abs(dx)>Math.abs(dy))navigate(dx<-25?'right':'left');else navigate(dy<-25?'down':'up')},{passive:true});
document.addEventListener('keydown',e=>{if(minimap.classList.contains('open')){if(e.key==='Escape')toggleMap();return}switch(e.key){case'ArrowRight':case'l':navigate('right');break;case'ArrowLeft':case'h':navigate('left');break;case'ArrowDown':case'j':case' ':navigate('down');e.preventDefault();break;case'ArrowUp':case'k':navigate('up');e.preventDefault();break;case'Escape':if(path.length>1)navigate('up');break;case'm':toggleMap();break}});
let wL=false;document.addEventListener('wheel',e=>{e.preventDefault();if(wL)return;wL=true;setTimeout(()=>wL=false,400);if(Math.abs(e.deltaX)>Math.abs(e.deltaY)&&Math.abs(e.deltaX)>10)navigate(e.deltaX>0?'right':'left');else if(Math.abs(e.deltaY)>10)navigate(e.deltaY>0?'down':'up')},{passive:false});
renderSlide(currentNode(),null);
</script>
</body>
</html>
